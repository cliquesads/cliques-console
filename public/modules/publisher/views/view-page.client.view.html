<section data-ng-init="findOne()">
    <div class="col-md-12 alert alert-danger" ng-show="saveerror">{{ saveerror }}</div>
    <!--Only show activate controls for admins right now-->
    <div class="col-sm-4">
        <div class="list-group">
            <div class="list-group-item">
                <span class="panel-title">
                    <i class="fa fa-cog"></i>&nbsp;Page Settings
                </span>
            </div>
            <div class="list-group-item">
                <div class="form-horizontal">
                    <div class="form-group m0" ng-show="authentication.user.roles.indexOf('admin') > -1">
                        <label class="control-label col-sm-3">Active</label>
                        <div class="col-sm-8">
                            <div class="form-control-static">
                                <label class="switch">
                                    <input type="checkbox" checked="checked" ng-model="page.active" ng-click="togglePageActive()"/>
                                    <span></span>
                                </label>
                                <div class="label" ng-class="page.active ? 'label-success':'label-default'">{{ page.active ? "Active":"Inactive"}}</div>
                            </div>
                        </div>
                        <div class="col-sm-1">
                            <a href="#" class="pull-right" ng-click="pageForm.$show()" ng-show="!pageForm.$visible">
                                <span class="fa fa-edit"></span>
                            </a>
                        </div>
                    </div>
                    <form editable-form name="pageForm" id="pageForm" onaftersave="update()">
                        <div class="form-group m0">
                            <label class="control-label col-sm-3">Name</label>
                            <div class="col-sm-9">
                                <p class="form-control-static">
                                    <span editable-text="page.name" e-name="name" id="name" required="required">{{ page.name }}</span>
                                </p>
                            </div>
                        </div>
                        <div class="form-group m0">
                            <label class="control-label col-sm-3">URL</label>
                            <div class="col-sm-9">
                                <p class="form-control-static">
                                    <span editable-text="page.url" e-name="url">{{ page.url }}</span>
                                </p>
                            </div>
                        </div>
                        <div class="form-group m0">
                            <label class="control-label col-sm-3">Description</label>
                            <div class="col-sm-9">
                                <p class="form-control-static">
                                <span editable-text="page.description" e-name="description">
                                    <hm-read-more
                                            hm-text="{{ page.description }}"
                                            hm-limit="20"
                                            hm-more-text="read more"
                                            hm-less-text="read less"
                                            hm-dots-class="dots"
                                            hm-link-class="links">
                                    </hm-read-more></span>
                                </p>
                            </div>
                        </div>
                        <!--<div class="form-group m0">-->
                            <!--<label class="control-label col-sm-3">Clique</label>-->
                            <!--<div class="col-sm-9">-->
                                <!--<p class="form-control-static">-->
                                    <!--<span>{{ page.clique || "empty" }}</span>-->
                                <!--</p>-->
                            <!--</div>-->
                        <!--</div>-->
                    </form>
                </div>
            </div>
            <div class="list-group-item" ng-show="pageForm.$visible">
                <div class="text-center">
                    <!-- buttons to submit / cancel form -->
                    <button type="submit" class="btn btn-xs btn-primary" ng-disabled="pageForm.$waiting">
                        Save
                    </button>
                    <button type="button" class="btn btn-xs btn-default" ng-disabled="pageForm.$waiting" ng-click="pageForm.$cancel()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
        <div class="list-group" data-ng-init="getQuickStats(dateRangeSelection)">
            <div class="list-group-item">
                <div class="panel-title">
                    <i class="fa fa-line-chart"></i>&nbsp;Page Stats
                </div>
            </div>
            <div class="list-group-item">
                <div class="row row-table">
                    <small>
                        {{ dateRanges[dateRangeSelection].label }}
                    </small>
                    <span class="pull-right">
                        <button class="btn btn-xs btn-default" ng-click="getQuickStats('7d')">7d</button>
                        <button class="btn btn-xs btn-default" ng-click="getQuickStats('30d')">30d</button>
                        <button class="btn btn-xs btn-default" ng-click="getQuickStats('90d')">90d</button>
                    </span>
                </div>
                <div class="row row-table text-center">
                    <div class="col-sm-6">
                        <div class="h3">{{ quickStats[0].spend | currency:"$":"0" }}</div>
                        <small class="text-muted">Revenue</small>
                    </div>
                    <div class="col-sm-6">
                        <div class="h3">{{ (quickStats[0].spend / quickStats[0].imps) * 1000 | currency:"$":"2" }}</div>
                        <small class="text-muted">Avg. RPM</small>
                    </div>
                </div>
                <div class="row row-table text-center">
                    <div class="col-sm-4">
                        <div class="h4">{{ quickStats[0].imps | number: 0 }}</div>
                        <small class="text-muted">Impressions</small>
                    </div>
                    <div class="col-sm-4">
                        <div class="h4">{{ quickStats[0].clicks / quickStats[0].imps | percentage:2 }}</div>
                        <small class="text-muted">CTR</small>
                    </div>
                    <div class="col-sm-4">
                        <div class="h4">{{ quickStats[0].clicks | number: 0 }}</div>
                        <small class="text-muted">Clicks</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-8">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <div class="panel-title">
                    <i class="fa fa-tags"></i>&nbsp;
                    Placement Manager
                </div>
            </div>
            <div class="panel-body">
                <fieldset>
                    <placement-form page="page" publisher="publisher"></placement-form>
                </fieldset>
            </div>
        </div>
    </div>
</section>